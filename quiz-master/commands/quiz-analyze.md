---
name: quiz-analyze
description: 分析薄弱知识点，生成详细学习报告和改进建议
allowed-tools:
  - Read
  - Bash
argument-hint: [--bank <name>] [--top N]
---

# Quiz Master - Analyze Weak Points

你正在帮助用户深入分析学习数据，找出薄弱知识点并提供改进建议。

## 任务步骤

### 1. 读取学习日志和题库

读取以下数据源：
- 所有学习日志：`~/.quiz-master/logs/session-*.log`
- 题库文件：`~/.quiz-master/banks/*.json`

### 2. 数据聚合分析

#### 2.1 题目级别分析

对每个题目统计：
- 错误次数
- 正确次数
- 平均用时
- 首次答题时间
- 最后答题时间
- 连续错误次数

#### 2.2 知识点级别分析

按标签聚合：
- 每个标签的总题数
- 每个标签的正确率
- 每个标签的错误集中度
- 每个标签的掌握程度分级

掌握程度分级：
- **掌握 (90-100%)**: 绿色 ✓
- **熟悉 (70-89%)**: 蓝色 ○
- **生疏 (50-69%)**: 橙色 △
- **薄弱 (0-49%)**: 红色 ✗

#### 2.3 时间趋势分析

- 最近7天、30天正确率变化
- 学习频率（每天/每周答题数）
- 知识点掌握度变化趋势

### 3. 生成详细报告

#### 3.1 执行摘要

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 学习分析报告
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📅 分析时间：{datetime}
📚 数据范围：{total_logs} 次会话，{total_questions} 道题
⏱️  时间跨度：{start_date} 至 {end_date}

总体表现：{performance_level}
  - 平均正确率：{overall_accuracy}%
  - 已掌握知识点：{mastered_count}/{total_tags}
  - 需重点关注：{weak_count} 个知识点
```

#### 3.2 知识点掌握矩阵

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 知识点掌握度分析
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

知识点          题目数  正确数  正确率  掌握度  变化
────────────────────────────────────────
{tag_name}      {total}  {correct}  {rate}%  ✓掌握  ⬆️
{tag_name}      {total}  {correct}  {rate}%  ○熟悉  ➡️
{tag_name}      {total}  {correct}  {rate}%  △生疏  ⬇️
{tag_name}      {total}  {correct}  {rate}%  ✗薄弱  ⬇️
...
```

#### 3.3 Top 10 薄弱知识点

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️  亟需加强的知识点
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. [{tag}]
   正确率：{rate}% ({correct}/{total})
   最近表现：连续错误 {streak} 次
   建议练习：使用 /quiz-start {bank} --mode smart

   典型错题：
   - Q{id}: {question}
     你的答案：{user_answer}
     正确答案：{correct_answer}

2. [{tag}]
   ...
```

#### 3.4 题目难度分析

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📈 难度分布与表现
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

难度      题目数  正确率  平均用时  建议
─────────────────────────────────────
简单      {count}   {rate}%   {time}s    可适当提高难度
中等      {count}   {rate}%   {time}s    当前水平合适
困难      {count}   {rate}%   {time}s    建议先巩固基础
```

#### 3.5 学习模式分析

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💡 学习习惯分析
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

学习频率：
  - 最近7天：{sessions} 次会话
  - 平均每天：{avg_daily} 题
  - 最佳时段：{best_time}

答题速度：
  - 平均用时：{avg_time} 秒/题
  - 最快题目：{fastest} 秒
  - 最慢题目：{slowest} 秒

学习建议：
  - {suggestion_1}
  - {suggestion_2}
```

### 4. 智能推荐

#### 4.1 个性化学习计划

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 个性化学习建议
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 本周重点：
   1. 复习 "{weak_tag_1}" 知识点（{count} 题）
   2. 巩固 "{weak_tag_2}" 知识点（{count} 题）

📚 推荐题库：
   - {bank_name}（智能模式）
   - {bank_name}（第 {start}-{end} 题）

⏰ 学习时间建议：
   - 每天 {min} 分钟，每次 {questions} 题
   - 最佳时间：{best_time}

🔁 复习计划：
   - 今天：复习 {tag1} 相关题目
   - 明天：复习 {tag2} 相关题目
   - 后天：综合测试
```

#### 4.2 具体行动步骤

```
立即行动：
  1. /quiz-start {bank} --mode smart --count 10
     （重点练习薄弱题目）

  2. /quiz-start {bank} --mode sequential --count 20
     （系统复习 {tag} 知识点）

  3. 三天后再次使用 /quiz-analyze 查看进步
```

### 5. 参数处理

**--bank <name>**: 只分析特定题库
- 过滤数据，只分析该题库的题目
- 提供更针对性的建议

**--top N**: 显示前 N 个薄弱知识点
- 默认显示 Top 10
- 可调整为 5, 15, 20 等

### 6. 导出报告

提供导出选项：
```
是否导出完整分析报告？(y/n)

导出格式：
  1. Markdown (.md)
  2. JSON (.json)
  3. 文本 (.txt)

报告将保存到：~/.quiz-master/reports/analysis-{timestamp}.md
```

## 使用示例

**完整分析**:
```bash
/quiz-analyze
```

**分析特定题库**:
```bash
/quiz-analyze --bank english-vocab
```

**只看 Top 5 薄弱点**:
```bash
/quiz-analyze --top 5
```

**分析并导出报告**:
```bash
/quiz-analyze --export markdown
```

## 分析算法详解

### 薄弱程度评分

综合以下因素计算薄弱分数：
```
weakness_score =
  (错误率 × 0.4) +
  (连续错误次数 × 0.3) +
  (距上次答题天数 × 0.2) +
  (平均答题时长 × 0.1)
```

### 知识点关联分析

识别经常一起答错的知识点：
- 如果 {tag1} 和 {tag2} 经常同时答错
- 说明它们可能相关，建议一起学习

### 遗忘曲线应用

基于艾宾浩斯遗忘曲线：
- 1天后：复习正确率 60% 以下的题目
- 3天后：复习正确率 80% 以下的题目
- 7天后：复习所有错误过的题目
- 30天后：全面复习

## 激励与反馈

根据分析结果给出正向激励：
```
🌟 进步亮点：
  - "{tag}" 知识点掌握度从 {old}% 提升到 {new}%
  - 连续学习 {days} 天，坚持不懈
  - 答题速度提升 {improvement}%

💪 你正在进步！继续保持！
```

## 错误处理

**数据不足**:
```
📊 数据不足，无法生成详细分析

建议：
  - 至少完成 20 题后再分析
  - 使用 /quiz-start 开始答题

当前进度：{count} 题
```

**所有题目都已掌握**:
```
🎉 恭喜！所有知识点都已掌握

正确率：{rate}%
薄弱知识点：0

建议：
  - 尝试更高难度的题库
  - 定期复习巩固（间隔1周）
```

## 相关命令

- `/quiz-status`: 查看基本统计
- `/quiz-start`: 开始针对性练习
- `/quiz-list`: 查看所有题库

## 相关技能

- `quiz-learning-analytics`: 提供分析算法和统计方法
- `learning-analyzer` agent: 智能学习分析
